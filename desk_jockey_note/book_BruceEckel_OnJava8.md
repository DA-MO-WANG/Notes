### Exceptions

有一句哲语：糟糕结构的code 将不能运行

改善错误恢复机制，是提升你的code健壮性的最有力的方式之一。Error recovery 是你写的每一个程序的根本要素。尤其是你在用Java开发某种供给别人使用的组件时，更是一个主要的目标点。

catch error的理想阶段是在编译阶段，也就是在你run 代码之前的时候。然而并不是所有的错误都能在编译阶段被侦查到。这些错误必须在运行时被处理，通过这样的机制：制造error的人传递适当的信息给能够解决这个问题的一方。

> 系统的健壮性建立在各个组件的健壮性的基础上

通过提供一种统一的错误报告模型基于各种exception，Java允许组件和调用它的客户端可靠地交流问题。在java 中处理异常的目标就是简化大型程序的构造，更有信心去应对应用程序不会出现无法处理的错误。Exceptions 学起来并不是很难，能够为你的项目提供立竿见影的好处。因为异常处理是Java提供的唯一的官方方式，而且被Java编译器强制执行。如果你不学习exception 处理的话，你也只能走到这里。本章交给你正确写代码来处理异常，并且如果你自己的方法陷入麻烦时，来产生你自己的异常。



#### concepts

C和其他早期语言，通常有多种异常处理模型。这些通常建立在约定俗成上，而不是作为编程语言的一部分。比如，你可以返回一个特定的值或者设置一个标识。调用方就能够确定哪里出现了问题。随着时间流逝，调用库的人通常不会认为自己的代码出了问题，而是认为别人出了问题。因此，一点也不奇怪，他不会检察各种错误情况。当然，如果他检查每一种情况，整个代码也会变得不可读。

一种解决方案是把异常处理抽象成一种特性，以一种机制来强制。实际上这种方案已经有很久的历史了，因为异常处理的实现可以追溯到上世纪60年代操作系统上，甚至是basic语言。当然C++异常处理是基于Ada语言的，而java主要基于C++.

"exception"这个单词就意味着意料之外的感觉。当问题发生时，你可能不知道怎么处理它，但是你知道你没法顺趟地继续执行下去。你不得不停下来，某个人，某个地方必须搞清楚发生了什么。但是在当时的环境中没有足够的信息来修复这个问题。因此你把这个问题上传给更高级别视野的层次的环境，那里的人有资格来做合适的决定。

Exceptions 能减轻错误处理代码的复杂度。不用exceptions, 你就必须自己检查特定的错误，然后处理，可能在程序的多个地方。用exce ptions的话，你就不必在方法调用的位置检查。因为exceptions机制能够保证某个人一定捕获了它。理想的情况是，你只需要在一个地方处理这个问题，这个地方被称为exception handler。这个地方可以放代码，也可以隔离正常情况下要跑的代码和错误情况下要走的代码。

谨慎使用，在代码读写、调试方面，用exceptions比使用老的一套处理异常的都变得更清晰。

#### Basic Exceptions

一个例外的情况就是这样的问题，阻止当前方法或者作用域往下走。区分exceptional problem 和 normal problem 很重要。normal problem 就是你在当前上下文环境中有足够的信息来处理问题；exceptional problem 就是你在当前上下文中，没有解决这个问题所需要的足够的信息。你能做的就是跳出当前环境，把这个问题提交到更高层次的环境中。这也是throw 意味的东西。

除法是一个简单的例子，如果你打算用0除，这种情况就得检查。但是分母为0到底意味什么？如果已经是0了，自然你可能知道怎么处理，如果这个值你不确定呢？这个时候你就得必须抛出一个异常，而不是沿着这个异常路径走下去。

当你抛出一个异常时，有几件事发生了。第一，异常对象就和其他普通的java对象一样，在堆上，用new来创造出来。原本要正常执行路径停了下来，这个异常对象的引用从当前上下文中抛出了。现在，异常处理机制已经结束了，到了开始寻找一个恰当的地方来继续执行这个程序了。这个恰当的地方，就是exception handler, 它的任务就是从问题中恢复出来，为了让程序或者走另一种轨迹或者继续下去。

谈一下抛出异常的一个简单的例子，考虑对象的引用被叫做t. 你可能拿到一个没有初始化的引用，因此在你使用它之前你得检查一下。你可以通过妆造一个代表你的信息的对象，然后o pa



